(()=>{(function(){const r=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:void 0;if(!r)return;const u=r.__RETARGLOW_PIXEL__||{},o=r.document,h=r.navigator,d=r.history;function O(){if(u.endpoint)try{return new URL(u.endpoint,r.location?r.location.href:void 0).origin.replace(/\/$/,"")}catch(e){}try{if(r.location&&r.location.origin)return r.location.origin.replace(/\/$/,"")}catch(e){}return"https://retarglow.com"}const k=O(),m=k+"/b";function N(){return typeof u.cid=="string"&&u.cid?u.cid:null}function g(){if(typeof u.url=="string")return u.url;try{if(o&&o.location&&typeof o.location.href=="string")return o.location.href;if(r.location&&typeof r.location.href=="string")return r.location.href}catch(e){}return null}function w(){try{if(o&&typeof o.referrer=="string"&&o.referrer)return o.referrer}catch(e){}return null}function E(){if(!r.screen)return null;const e=Number(r.screen.width)||0,n=Number(r.screen.height)||0;return!e||!n?null:e+"x"+n}function B(){if(!o)return null;const e=o.documentElement,n=Number(r.innerWidth||e&&e.clientWidth||0),i=Number(r.innerHeight||e&&e.clientHeight||0);return!n||!i?null:n+"x"+i}function _(){return Date.now()}function j(e,n){if(!n||typeof n!="object")return e;for(const i of Object.keys(n)){const c=n[i];c!==void 0&&(e[i]=c)}return e}const t={pending:[],flushing:!1,timer:null,backoff:1e3,currentUrl:null,previousUrl:null,lastToken:null};function b(e){const n=typeof e=="number"&&e>0?e:250;t.timer||(t.timer=r.setTimeout(()=>{t.timer=null,p()},n))}function v(e,n){const i=t.currentUrl||g(),c=t.previousUrl&&t.previousUrl!==i?t.previousUrl:w(),a={type:typeof e=="string"?e:"event",url:i,referrer:c||null,title:o&&typeof o.title=="string"?o.title:null,ts:_(),screen:E(),extra:{viewport:B()}};j(a.extra,n),t.pending.push(a),b()}function R(e){if(!(!e||typeof e!="object")&&e.token&&typeof e.token=="string"&&e.token!==t.lastToken){t.lastToken=e.token;const n=typeof e.frame_src=="string"&&e.frame_src?e.frame_src:k+"/frame?token="+encodeURIComponent(e.token);q(n)}}function q(e){if(!o||!e)return;const n=o.createElement("iframe");n.src=e,n.setAttribute("sandbox","allow-scripts allow-same-origin"),n.setAttribute("referrerpolicy","no-referrer"),n.setAttribute("aria-hidden","true"),n.style.cssText="display:none;width:0;height:0;border:0;";const i=o.body||o.documentElement;i&&i.appendChild(n)}function p(e){if(!t.pending.length)return;const n=e&&e.forceBeacon&&h&&typeof h.sendBeacon=="function",i=t.pending.splice(0,t.pending.length),c={cid:N(),url:t.currentUrl||g(),screen:E(),events:i},a=JSON.stringify(c);if(n){try{const s=new Blob([a],{type:"application/json"});if(h.sendBeacon(m,s)){t.backoff=1e3;return}}catch(s){}t.pending=i.concat(t.pending),b(t.backoff);return}if(t.flushing){t.pending=i.concat(t.pending);return}t.flushing=!0,r.fetch(m,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:a}).then(s=>!s||!s.ok?null:s.json().catch(()=>null)).then(s=>{t.backoff=1e3,R(s)}).catch(()=>{t.pending=i.concat(t.pending),t.backoff=Math.min(t.backoff*2,3e4)}).finally(()=>{t.flushing=!1,t.pending.length&&b(t.backoff)})}function f(e){const n=g();if(!n||!e&&t.currentUrl===n)return;t.previousUrl=t.currentUrl,t.currentUrl=n;const i=t.previousUrl&&t.previousUrl!==n?t.previousUrl:w();v("pageview",{referrer:i})}function U(e){if(!d||typeof d[e]!="function")return;const n=d[e];d[e]=function(){const c=n.apply(this,arguments);return Promise.resolve().then(()=>f(!0)),c}}function C(){U("pushState"),U("replaceState"),r.addEventListener&&(r.addEventListener("popstate",()=>f(!0)),r.addEventListener("hashchange",()=>f(!0)))}const L=new WeakSet,S=new WeakSet;let l=null;function I(e){L.has(e)||(L.add(e),v("view",{target:e.getAttribute("data-track")||null,id:e.id||null}))}function M(){l||!r.IntersectionObserver||(l=new IntersectionObserver(e=>{for(const n of e)n.isIntersecting&&(I(n.target),l.unobserve(n.target))},{threshold:.2}))}function y(e){if(!e||S.has(e))return;S.add(e);const n=e.getAttribute("data-track")||e.id||e.tagName.toLowerCase();e.addEventListener("click",()=>{v("interaction",{target:n,id:e.id||null,role:e.getAttribute("role")||null})},{passive:!0}),M(),l&&l.observe(e)}function T(){if(!o||!o.querySelectorAll)return;const e=o.querySelectorAll("[data-track]");for(const n of e)y(n)}function A(){if(!o||!o.querySelectorAll||!r.MutationObserver){T();return}T(),new MutationObserver(n=>{for(const i of n)if(i.addedNodes){for(const c of i.addedNodes)if(c instanceof r.Element&&(c.matches&&c.matches("[data-track]")&&y(c),c.querySelectorAll)){const a=c.querySelectorAll("[data-track]");for(const s of a)y(s)}}}).observe(o.documentElement||o.body,{childList:!0,subtree:!0})}function H(){o&&(o.readyState==="complete"||o.readyState==="interactive"?(f(!0),A()):o.addEventListener("DOMContentLoaded",()=>{f(!0),A()},{once:!0}),r.addEventListener&&(r.addEventListener("visibilitychange",()=>{o.visibilityState==="hidden"&&p({forceBeacon:!0})}),r.addEventListener("pagehide",()=>{p({forceBeacon:!0})}),r.addEventListener("beforeunload",()=>{p({forceBeacon:!0})})))}C(),H()})();})();